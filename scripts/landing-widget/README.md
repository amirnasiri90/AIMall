# ویجت سرچ «میخوای چه کار کنی؟» برای صفحهٔ اصلی

این ویجت همان سرچ‌باکس داشبورد است که کاربر با نوشتن خواسته‌اش به بخش مناسب راهنمایی می‌شود. برای استفاده **فقط در صفحهٔ اول سایت** (قالب HTML + JS) طراحی شده است.

- با **شماره موبایل**: درخواست به API ارسال می‌شود و پیشنهاد با **هوش مصنوعی** برمی‌گردد.
- بدون شماره یا در صورت خطا: فقط **تطبیق کلیدواژه** (همان لیست ثابت) استفاده می‌شود.

## فایل‌ها

- **`aimall-intent-search.js`** — اسکریپت ویجت (فقط همین یک فایل لازم داری)
- **`embed-example.html`** — نمونهٔ استفاده در یک صفحهٔ HTML

## API عمومی (بک‌اند)

- **مسیر:** `POST /api/v1/public/landing/intent/classify`
- **بدن:** `{ "text": "میخوام عکس بسازم", "phone": "09123456789" }`
- **احراز هویت:** فقط شماره موبایل (بدون JWT/API-Key).
- **امنیت:**
  - محدودیت نرخ **per IP**: ۱۵ درخواست در دقیقه.
  - محدودیت نرخ **per شماره**: ۵ درخواست در دقیقه.
  - اعتبارسنجی شماره: فقط موبایل ایران `09xxxxxxxxx`.

## نحوهٔ استفاده در صفحهٔ اول

### ۱. کپی کردن اسکریپت

فایل `aimall-intent-search.js` را در سایت خود (همان دامنهٔ صفحهٔ اول) قرار بده، مثلاً در `/js/aimall-intent-search.js`.

### ۲. پیکربندی (قبل از لود اسکریپت)

در `<head>` یا قبل از اسکریپت:

```html
<script>
  window.AIMALL_INTENT_SEARCH_CONFIG = {
    baseUrl: 'https://panel.aifoapp.ir',    // آدرس پنل برای لینک «ورود به بخش»
    apiUrl: 'https://api.aifoapp.ir/api/v1', // آدرس API (برای تحلیل با AI؛ اختیاری)
    containerId: 'aimall-intent-search'     // اختیاری
  };
</script>
```

- **baseUrl**: آدرسی که لینک «ورود به بخش» به آن می‌رود.
- **apiUrl**: اگر تنظیم شود و کاربر شماره معتبر وارد کند، از API تحلیل قصد استفاده می‌شود؛ در غیر این صورت فقط کلیدواژه.
- **containerId**: در صورت نیاز، شناسهٔ المنت را عوض کن.

### ۳. قرار دادن ویجت در صفحه

```html
<div id="aimall-intent-search"></div>
<script src="/js/aimall-intent-search.js"></script>
```

## رفتار

- کاربر می‌تواند **شماره موبایل** و **متن خواسته** را وارد کند و «تحلیل کن» بزند.
- اگر `apiUrl` تنظیم شده و شماره معتبر باشد، درخواست به API فرستاده می‌شود و در صورت موفقیت نتیجهٔ AI نمایش داده می‌شود.
- در صورت خطا (شبکه، ۴۲۹، یا پاسخ خالی) یا عدم وارد کردن شماره، ویجت با **کلیدواژه** همان متن را تطبیق می‌دهد و در صورت تطابق، کارت و لینک «ورود به بخش» را نشان می‌دهد.
- لینک به `baseUrl + مسیر بخش` می‌رود (مثلاً `https://panel.aifoapp.ir/image-studio`).

## وابستگی

- فقط vanilla JS؛ نیازی به React یا کتابخانهٔ دیگر نیست.
- برای ظاهر بهتر می‌توانی فونت **Vazirmatn** را لود کنی (مثل `embed-example.html`).

## سفارشی‌سازی ظاهر

استایل‌ها داخل اسکریپت به صورت inline هستند. اگر خواستی ظاهر را عوض کنی، می‌توانی در قالب خودت با CSS کلاس‌های `.aimall-intent-*` آن‌ها را override کنی یا یک نسخهٔ ویرایش‌شده از اسکریپت با استایل‌های دلخواه بسازی.
