# PWA و ریسپانسیو — راهنمای فرانت‌اند

این سند خلاصهٔ تنظیمات **PWA** و **ریسپانسیو** در فرانت‌اند است و بعد از بهبودهای اخیر به‌روز شده است.

---

## ریسپانسیو (خلاصهٔ تغییرات اخیر)

- **بدنه و اسکرول:** `html, body` با `overflow-x: hidden` تا در موبایل اسکرول افقی نداشته باشیم.
- **Safe area:** کلاس‌های `.safe-area-inset-top` و `.safe-area-inset-bottom` برای ناچ و نوار home در دستگاه‌های موبایل.
- **داشبورد:** نوار بالای موبایل با دکمه منو ۴۴px؛ GenieRail فقط از `md` به بعد؛ فاصله‌ها و padding با `p-2 sm:p-4` و `gap-2 sm:gap-4`.
- **چت:** فاصله بین لیست و پنل `gap-2 sm:gap-4`؛ حباب پیام `max-w-[90%] sm:max-w-[75%]`؛ نوار مدل (سریع/اقتصادی/دقیق) روی موبایل فقط آیکون، از `sm` متن کامل؛ دیالوگ‌ها `w-[calc(100vw-2rem)]` و `max-h-[calc(100dvh-2rem)]` با اسکرول داخلی.
- **داشبورد خانه:** عنوان‌ها `text-2xl sm:text-3xl`؛ فرم جستجو روی موبایل عمودی؛ کارت‌ها و گریدها با `grid-cols-1 sm:grid-cols-2` و padding واکنش‌گرا.
- **ورود/ثبت‌نام:** کارت با padding کمتر روی موبایل؛ تب‌ها با متن کوتاه‌تر؛ ردیف موبایل/دکمه به صورت عمودی روی موبایل.
- **منوی موبایل:** عرض `min(280px, 85vw)`؛ آیتم‌های منو `min-h-[44px]` برای لمس راحت؛ حالت فعال با `pathname.startsWith` برای زیرمسیرها.

---

## PWA (Progressive Web App)

### چه چیزهایی اضافه شده؟

- **مانیفست:** فایل `src/app/manifest.ts` برای نصب اپ روی صفحهٔ اصلی (دسکتاپ و موبایل).
  - نام: AiFO
  - حالت نمایش: `standalone`
  - آیکون‌ها: از `/logo.png` استفاده می‌شود. برای کیفیت بهتر می‌توانید آیکون‌های ۱۹۲×۱۹۲ و ۵۱۲×۵۱۲ پیکسل در `public/` قرار دهید و در مانیفست به آن‌ها لینک دهید.
- **متادیتای viewport و theme:** در `src/app/layout.tsx` با `export const viewport` تنظیم شده (عرض دستگاه، scale، رنگ نوار وضعیت در حالت لایت/دارک).
- **Apple Web App:** `appleWebApp` در metadata برای نوار وضعیت و عنوان در iOS.

### نصب روی صفحهٔ اصلی

- در **Chrome/Edge (دسکتاپ و اندروید):** بعد از باز کردن سایت، آیکون «نصب اپ» در آدرس‌بار یا منوی ⋮ نمایش داده می‌شود (با HTTPS و مانیفست معتبر).
- در **سافاری iOS:** منوی Share (⎋) → «Add to Home Screen» (➕).

### سرویس ورکر و آفلاین (اختیاری)

برای کش کردن و کار آفلاین می‌توان از کتابخانه‌هایی مثل [Serwist](https://github.com/serwist/serwist) با Next.js استفاده کرد. در حال حاضر فقط مانیفست و متادیتا برای **قابلیت نصب** تنظیم شده است.

---

## ریسپانسیو

### داشبورد

- **موبایل (< 768px):**
  - نوار بالایی با دکمهٔ منو (همبرگر) + لوگو. با زدن منو، **MobileSidebar** باز می‌شود و همهٔ لینک‌های ناو (داشبورد، چت، استودیوها، صورتحساب، تنظیمات و …) در دسترس است.
  - **GenieRail** مخفی است تا فضای بیشتری به محتوا داده شود.
  - فاصله‌ها و گوشه‌های گرد با کلاس‌های `p-2 sm:p-4` و `rounded-2xl sm:rounded-[28px]` روی موبایل کوچک‌تر و روی دسکتاپ بزرگ‌تر هستند.
- **دسکتاپ (≥ 768px):**
  - **GenieRail** در سمت راست نمایش داده می‌شود و منوی موبایل مخفی است.

### Safe Area

در `globals.css` برای دستگاه‌های با ناچ (مثل آیفون) از `env(safe-area-inset-*)` برای padding بدن استفاده شده تا محتوا زیر ناچ یا نوار home نرود.

### چت

- لیست گفتگوها روی موبایل می‌تواند با toggle مخفی/نمایش داده شود و عرض آن با `w-full md:w-72 lg:w-80` ریسپانسیو است.

---

## چک‌لیست تست

- [ ] باز کردن سایت در Chrome موبایل و استفاده از «Add to Home Screen» یا «Install app»
- [ ] باز کردن از آیکون نصب‌شده و بررسی نمایش standalone و نوار وضعیت
- [ ] تست منوی همبرگر در داشبورد و باز/بسته شدن MobileSidebar
- [ ] تست چت روی عرض کم (لیست و پنل گفتگو)
- [ ] تست در سافاری iOS و نصب از Share → Add to Home Screen
